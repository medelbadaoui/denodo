CREATE OR REPLACE VIEW iv_full_employees_age_cat FOLDER = '/integration' AS SELECT iv_full_employees.fulldate AS fulldate, iv_full_employees.month AS month, iv_full_employees.sal_mat_paie AS sal_mat_paie, iv_full_employees.sal_empli AS sal_empli, iv_full_employees.date_ent AS date_ent, iv_full_employees.date_fin AS date_fin, iv_full_employees.sal_motifsot AS sal_motifsot, iv_full_employees.sal_motif_ent AS sal_motif_ent, iv_full_employees.type_contrat AS type_contrat, iv_full_employees.sal_danc AS sal_danc, iv_full_employees.sal_catsoc AS sal_catsoc, iv_full_employees.sal_hmens AS sal_hmens, iv_full_employees.sal_qualif_referentiel AS sal_qualif_referentiel, iv_full_employees.num_rtablissement AS num_rtablissement, iv_full_employees.id_paye AS id_paye, iv_full_employees.nom_payé AS nom_payé, iv_full_employees.desc_motif_sort AS desc_motif_sort, iv_full_employees.nom_etabl AS nom_etabl, iv_full_employees.full_name AS full_name, iv_full_employees.date_nais AS date_nais, iv_full_employees.ind_sexe AS ind_sexe, iv_full_employees.mail AS mail, iv_full_employees.nb_enf AS nb_enf, iv_full_employees.age AS age, iv_full_employees.age_in_period AS age_in_period, case WHEN (iv_full_employees.age_in_period <= 24) THEN '0-24' WHEN ((iv_full_employees.age_in_period >= 25 AND iv_full_employees.age_in_period <= 34)) THEN '25-34' WHEN ((iv_full_employees.age_in_period >= 35 AND iv_full_employees.age_in_period <= 44)) THEN '35-44' WHEN ((iv_full_employees.age_in_period >= 45 AND iv_full_employees.age_in_period <= 54)) THEN '45-54' WHEN ((iv_full_employees.age_in_period >= 55 AND iv_full_employees.age_in_period <= 59)) THEN '55-59' ELSE '60-x' END AS age_cat, iv_full_employees.job_type AS job_type, iv_full_employees.new_member AS new_member, iv_full_employees.left_member AS left_member FROM iv_full_employees;

ALTER VIEW iv_full_employees_age_cat
 LAYOUT (iv_full_employees = [20, 20, 234, 585]);

