CREATE OR REPLACE VIEW iv_full_employees_info FOLDER = '/integration' AS SELECT bv_enterprise.sal_mat_paie AS sal_mat_paie, bv_enterprise.sal_empli AS sal_empli, to_localdate('MM/dd/yyyy', bv_enterprise.date_ent) AS date_ent, to_localdate('MM/dd/yyyy', bv_enterprise.date_fin) AS date_fin, bv_enterprise.sal_motifsot AS sal_motifsot, bv_enterprise.sal_motif_ent AS sal_motif_ent, bv_enterprise.type_contrat AS type_contrat, bv_enterprise.sal_danc AS sal_danc, bv_enterprise.sal_catsoc AS sal_catsoc, bv_enterprise.sal_hmens AS sal_hmens, bv_enterprise.sal_qualif_referentiel AS sal_qualif_referentiel, bv_enterprise.num_rtablissement AS num_rtablissement, bv_pays.id_paye AS id_paye, bv_pays.nom_payé AS nom_payé, bv_motif_sort.desc_motif_sort AS desc_motif_sort, bv_etablissement.nom_etabl AS nom_etabl, bv_employe_csv.full_name AS full_name, to_localdate('MM/dd/yyyy', bv_employe_csv.date_nais) AS date_nais, case WHEN ((bv_employe_csv.ind_sexe = 'Homme' OR bv_employe_csv.ind_sexe = 'mal')) THEN 'M' WHEN ((bv_employe_csv.ind_sexe = 'Femme' OR bv_employe_csv.ind_sexe = 'female')) THEN 'F' END AS ind_sexe, bv_employe_csv.mail AS mail, bv_employe_csv.nb_enf AS nb_enf, bv_employe_csv.age AS age, case WHEN (bv_enterprise.sal_hmens >= 152) THEN 'full-time' ELSE 'part-time' END AS j_type, (getyear(current_date())-getyear(to_localdate('MM/dd/yyyy', date_nais))) AS age_in_last_month FROM (((bv_enterprise AS bv_enterprise INNER JOIN bv_employe_csv AS bv_employe_csv ON bv_enterprise.sal_empli = bv_employe_csv.sal_empl ) INNER JOIN bv_motif_sort AS bv_motif_sort ON bv_enterprise.sal_motifsot = bv_motif_sort.code_motif_sort ) INNER JOIN bv_etablissement AS bv_etablissement ON bv_enterprise.num_rtablissement = bv_etablissement.code_etabl ) INNER JOIN bv_pays AS bv_pays ON bv_etablissement.code_paye = bv_pays.id_paye ;

ALTER VIEW iv_full_employees_info
 LAYOUT (bv_enterprise = [90, 150, 280, 265], bv_employe_csv = [730, 60, 200, 165], bv_motif_sort = [730, 310, 200, 65], bv_etablissement = [730, 560, 200, 85], bv_pays = [730, 410, 200, 65]);

