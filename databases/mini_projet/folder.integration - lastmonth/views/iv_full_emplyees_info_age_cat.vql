CREATE OR REPLACE VIEW iv_full_emplyees_info_age_cat FOLDER = '/integration - lastmonth' AS SELECT iv_full_employees_info.sal_mat_paie AS sal_mat_paie, iv_full_employees_info.sal_empli AS sal_empli, iv_full_employees_info.date_ent AS date_ent, iv_full_employees_info.date_fin AS date_fin, iv_full_employees_info.sal_motifsot AS sal_motifsot, iv_full_employees_info.sal_motif_ent AS sal_motif_ent, iv_full_employees_info.type_contrat AS type_contrat, iv_full_employees_info.sal_danc AS sal_danc, iv_full_employees_info.sal_catsoc AS sal_catsoc, iv_full_employees_info.sal_hmens AS sal_hmens, iv_full_employees_info.sal_qualif_referentiel AS sal_qualif_referentiel, iv_full_employees_info.num_rtablissement AS num_rtablissement, iv_full_employees_info.id_paye AS id_paye, iv_full_employees_info.nom_payé AS nom_payé, iv_full_employees_info.desc_motif_sort AS desc_motif_sort, iv_full_employees_info.nom_etabl AS nom_etabl, iv_full_employees_info.full_name AS full_name, iv_full_employees_info.date_nais AS date_nais, iv_full_employees_info.ind_sexe AS ind_sexe, iv_full_employees_info.mail AS mail, iv_full_employees_info.nb_enf AS nb_enf, iv_full_employees_info.age AS age, iv_full_employees_info.j_type AS j_type, iv_full_employees_info.age_in_last_month AS age_in_last_month, case WHEN (iv_full_employees_info.age_in_last_month <= 24) THEN '0-24' WHEN ((iv_full_employees_info.age_in_last_month >= 25 AND iv_full_employees_info.age_in_last_month <= 34)) THEN '25-34' WHEN ((iv_full_employees_info.age_in_last_month >= 35 AND iv_full_employees_info.age_in_last_month <= 44)) THEN '35-44' WHEN ((iv_full_employees_info.age_in_last_month >= 45 AND iv_full_employees_info.age_in_last_month <= 54)) THEN '45-54' WHEN ((iv_full_employees_info.age_in_last_month >= 55 AND iv_full_employees_info.age_in_last_month <= 59)) THEN '55-59' ELSE '60-x' END AS age_cat_lm FROM iv_full_employees_info;

ALTER VIEW iv_full_emplyees_info_age_cat
 LAYOUT (iv_full_employees_info = [20, 20, 234, 505]);

